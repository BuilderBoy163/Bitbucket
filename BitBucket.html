<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HexTrainer Duolingo Clone</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&display=swap');
    :root {
      --primary-bg: #f5f9ff;
      --accent: #6a5acd;
      --accent-light: #8b7afc;
      --text-primary: #222;
      --tooltip-bg: #e3e9ff;
      --correct: #4caf50;
      --incorrect: #f44336;
      --border: #ccc;
      --xp-bg: #dbe4ff;
      --xp-fill: linear-gradient(90deg, #6a5acd, #8b7afc);
      --button-bg: #6a5acd;
      --button-hover: #574bc8;
      --shadow: rgba(106, 90, 205, 0.25);
    }
    body {
      margin: 0; padding: 0;
      font-family: 'Quicksand', sans-serif;
      background: var(--primary-bg);
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 2rem 1rem;
      user-select: none;
    }
    header {
      font-weight: 700;
      font-size: 2.5rem;
      margin-bottom: 1.5rem;
      letter-spacing: 1.2px;
      color: var(--accent);
      text-shadow: 0 0 4px var(--accent-light);
      user-select: none;
    }
    .container {
      background: rgba(255 255 255 / 0.9);
      backdrop-filter: saturate(180%) blur(12px);
      box-shadow: 0 8px 20px var(--shadow);
      border-radius: 16px;
      padding: 2rem 2.5rem;
      width: 100%;
      max-width: 520px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      position: relative;
    }
    .word-display {
      font-size: 3rem;
      font-weight: 700;
      letter-spacing: 0.15em;
      display: flex;
      gap: 0.6rem;
      color: var(--accent);
      text-shadow: 0 0 3px var(--accent-light);
    }
    .letter {
      position: relative;
      cursor: help;
      padding: 0 0.25rem;
      border-radius: 6px;
      transition: background-color 0.3s ease;
      font-weight: 700;
      display: inline-block;
      user-select: none;
    }
    .letter:hover {
      background: var(--tooltip-bg);
      box-shadow: 0 0 8px var(--accent-light);
      color: var(--accent-light);
    }
    .letter::after {
      content: attr(data-binary);
      position: absolute;
      bottom: 140%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--tooltip-bg);
      color: var(--accent);
      padding: 0.3rem 0.65rem;
      border-radius: 10px;
      font-size: 0.85rem;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      font-weight: 600;
      user-select: text;
      filter: drop-shadow(0 0 1px var(--accent));
      z-index: 10;
    }
    .letter:hover::after {
      opacity: 1;
      pointer-events: auto;
    }
    .input-section {
      width: 100%;
      display: flex;
      gap: 1rem;
      justify-content: center;
      align-items: center;
    }
    input#input {
      flex-grow: 1;
      padding: 0.8rem 1rem;
      font-size: 1.3rem;
      border-radius: 12px;
      border: 2px solid var(--accent-light);
      outline-offset: 2px;
      transition: border-color 0.3s ease;
      font-weight: 600;
      font-family: 'Quicksand', sans-serif;
      color: var(--text-primary);
    }
    input#input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 10px var(--accent);
    }
    button#submit {
      background: var(--button-bg);
      color: white;
      font-weight: 700;
      font-size: 1.3rem;
      padding: 0.8rem 1.8rem;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(106,90,205,0.3);
      transition: background-color 0.25s ease, box-shadow 0.3s ease;
      user-select: none;
      flex-shrink: 0;
    }
    button#submit:hover {
      background: var(--button-hover);
      box-shadow: 0 8px 20px rgba(106,90,205,0.5);
    }
    button#submit:active {
      transform: scale(0.98);
      box-shadow: 0 4px 10px rgba(106,90,205,0.6);
    }
    .streak, .xp-bar, .badges {
      width: 100%;
      text-align: center;
      font-weight: 600;
      user-select: none;
    }
    .streak {
      font-size: 1.2rem;
      color: #555;
    }
    .xp-bar-container {
      margin-top: 0.6rem;
      height: 14px;
      background: var(--xp-bg);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }
    .xp-bar-fill {
      height: 100%;
      width: 0%;
      background: var(--xp-fill);
      border-radius: 14px 0 0 14px;
      transition: width 0.5s ease;
      box-shadow: 0 0 8px var(--accent-light);
    }
    .badges {
      margin-top: 1rem;
      min-height: 1.4rem;
    }
    .badge {
      display: inline-block;
      background: var(--accent);
      color: white;
      border-radius: 20px;
      padding: 0.3rem 0.9rem;
      margin: 0 0.3rem;
      font-size: 0.9rem;
      text-shadow: 0 0 3px var(--accent-light);
      user-select: none;
    }
    .feedback {
      font-size: 1.3rem;
      min-height: 3.2rem;
      margin-top: 0.4rem;
      white-space: pre-wrap;
      user-select: none;
      line-height: 1.3;
    }
    /* Settings gear */
    #settings-btn {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: transparent;
      border: none;
      cursor: pointer;
      outline: none;
      width: 36px;
      height: 36px;
      padding: 0;
      filter: drop-shadow(0 0 1px var(--accent));
      transition: filter 0.2s ease;
      z-index: 10;
    }
    #settings-btn:hover {
      filter: drop-shadow(0 0 5px var(--accent));
    }
    #settings-icon {
      width: 100%;
      height: 100%;
      fill: var(--accent);
      pointer-events: none;
    }
    /* Confetti */
    .confetti-piece {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: var(--accent);
      opacity: 0.8;
      pointer-events: none;
      border-radius: 2px;
      animation: confetti-fall linear forwards;
      z-index: 9999;
    }
    @keyframes confetti-fall {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <header>HexTrainer</header>

  <button id="settings-btn" title="Toggle sounds" aria-label="Toggle sound effects">
    <svg id="settings-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false" >
      <path d="M19.14 12.936a7.974 7.974 0 000-1.872l2.036-1.59-2-3.464-2.456.57a7.994 7.994 0 00-1.536-1.536l.57-2.456-3.464-2-1.59 2.036a7.974 7.974 0 00-1.872 0l-1.59-2.036-3.464 2 0.57 2.456a7.994 7.994 0 00-1.536 1.536l-2.456-.57-2 3.464 2.036 1.59a7.974 7.974 0 000 1.872l-2.036 1.59 2 3.464 2.456-.57a7.994 7.994 0 001.536 1.536l-.57 2.456 3.464 2 1.59-2.036a7.974 7.974 0 001.872 0l1.59 2.036 3.464-2-.57-2.456a7.994 7.994 0 001.536-1.536l2.456.57 2-3.464-2.036-1.59zM12 15.6A3.6 3.6 0 1112 8.4a3.6 3.6 0 010 7.2z"/>
    </svg>
  </button>

  <main class="container" role="main" aria-live="polite" aria-atomic="true">
    <div class="word-display" id="wordDisplay" aria-label="Word to translate"></div>

    <div class="input-section">
      <input type="text" id="input" placeholder="Type the word" autocomplete="off" spellcheck="false" aria-label="Type the word" />
      <button id="submit" aria-label="Submit your answer">Submit</button>
    </div>

    <div class="feedback" id="feedback"></div>

    <div class="streak" aria-live="polite">üî• Streak: <span id="streak">0</span></div>

    <div class="xp-bar" aria-label="XP progress">
      üìà XP:
      <div class="xp-bar-container">
        <div class="xp-bar-fill" id="xpBar"></div>
      </div>
    </div>

    <div class="badges" aria-live="polite">üèÜ Badges: <span id="badges"></span></div>
  </main>

<script>
  const words = [
    'hello', 'hex', 'byte', 'train', 'learn', 'quantum', 'entangle', 'neuron', 'vector', 'syntax'
  ];

  let currentWord = '';
  let streak = 0;
  let xp = 0;
  const xpPerCorrect = 10;
  let soundsOn = true;

  const successSound = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
  const failSound = new Audio('https://actions.google.com/sounds/v1/cartoon/boing.ogg');

  const wordDisplay = document.getElementById('wordDisplay');
  const input = document.getElementById('input');
  const submit = document.getElementById('submit');
  const streakEl = document.getElementById('streak');
  const xpBar = document.getElementById('xpBar');
  const badgesEl = document.getElementById('badges');
  const feedback = document.getElementById('feedback');
  const settingsBtn = document.getElementById('settings-btn');

  function toBinary(char) {
    return char.charCodeAt(0).toString(2).padStart(8, '0');
  }

  function renderWord(word) {
    wordDisplay.innerHTML = '';
    for (let char of word) {
      const span = document.createElement('span');
      span.classList.add('letter');
      span.textContent = char;
      span.setAttribute('data-binary', toBinary(char));
      wordDisplay.appendChild(span);
    }
  }

  function nextWord() {
    currentWord = words[Math.floor(Math.random() * words.length)];
    renderWord(currentWord);
    input.value = '';
    feedback.textContent = '';
    input.focus();
  }

  function updateXPBar() {
    xpBar.style.width = Math.min(xp, 100) + '%';
  }

  function clearBadges() {
    badgesEl.innerHTML = '';
  }

  function updateBadges() {
    clearBadges();
    if (streak >= 3) badgesEl.innerHTML += '<span class="badge">Hexling</span>';
    if (streak >= 5) badgesEl.innerHTML += '<span class="badge">Byte-Slinger</span>';
    if (streak >= 10) badgesEl.innerHTML += '<span class="badge">Binary Boss</span>';
  }

  function playSound(sound) {
    if (!soundsOn) return;
    sound.currentTime = 0;
    sound.play();
  }

  function confettiBurst() {
    const confettiCount = 30;
    for(let i=0; i<confettiCount; i++) {
      const confetti = document.createElement('div');
      confetti.classList.add('confetti-piece');
      confetti.style.left = Math.random() * window.innerWidth + 'px';
      confetti.style.backgroundColor = `hsl(${Math.random()*360}, 70%, 65%)`;
      confetti.style.animationDuration = (Math.random()*2 + 2) + 's';
      confetti.style.opacity = 0.8;
      document.body.appendChild(confetti);
      setTimeout(() => confetti.remove(), 3500);
    }
  }

  submit.addEventListener('click', () => {
    const val = input.value.trim().toLowerCase();

    if (val === currentWord) {
      // Correct answer
      streak++;
      xp += xpPerCorrect;
      feedback.textContent = `‚úÖ Correct! You typed "${currentWord}" üéâ`;
      feedback.style.color = 'var(--correct)';
      playSound(successSound);
      confettiBurst();
      streakEl.textContent = streak;
      updateXPBar();
      updateBadges();
      nextWord();
    } else {
      // Incorrect answer ‚Äî show exactly what letters are wrong
      streak = 0;
      streakEl.textContent = streak;
      updateBadges();

      let errorMsg = '‚ùå Nope, try again.\n';
      // Compare letter by letter
      const len = Math.max(val.length, currentWord.length);
      let wrongIndices = [];
      for (let i = 0; i < len; i++) {
        if (val[i] !== currentWord[i]) {
          wrongIndices.push(i);
        }
      }

      // Build string showing user input + markers
      let displayInput = '';
      let markers = '';
      for (let i = 0; i < currentWord.length; i++) {
        const userChar = val[i] || '_';
        displayInput += userChar;
        if (wrongIndices.includes(i)) {
          markers += '‚ùå';
        } else {
          markers += '‚úîÔ∏è';
        }
      }

      errorMsg += `Your input: ${displayInput}\n          ${markers}`;

      feedback.style.whiteSpace = 'pre-wrap';
      feedback.textContent = errorMsg;
      feedback.style.color = 'var(--incorrect)';
      playSound(failSound);
      input.value = '';
      input.focus();
    }
  });

  input.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      submit.click();
    }
  });

  settingsBtn.addEventListener('click', () => {
    soundsOn = !soundsOn;
    settingsBtn.style.filter = soundsOn ? 'drop-shadow(0 0 5px var(--accent))' : 'grayscale(1)';
  });

  // Initialize
  nextWord();
  updateXPBar();
  updateBadges();
</script>

</body>
</html>
